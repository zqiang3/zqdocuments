sync是一个linux同步命令，含义为迫使缓冲块数据立即写盘并更新超级块。

## man

NAME

​	sync- flush file system buffers

DESCRIPTION

​	Force changed blocks to disk, update the block.

## 使用原理

在linux系统中，为了加快数据的读取速度，默认情况下，某些数据将不会直接写入硬盘，而是先暂存内存中，如果一个数据被重复写，这样速度一定快，但存在一个问题，万一重新启动，或者是关机，或者是不正常断电的情况下，由于数据还没来得及存入硬盘，会造成数据更新不正常，这时需要命令sync进行数据的写入，即#sync，在内存中尚未更新的的数据会写入硬盘中。当然正常情况下，关闭系统时会自动进行内存数据于硬盘数据的同步检测，保证硬盘数据在关闭系统时是最新的。

## 使用场合

1. 在关机或者开机之前最好多执行这个几次，以确保数据写入硬盘。
2. 挂载时，需要很长时间的操作动作（比如，cp 大文件，检测文件），在这个动作之后接sync。
3. 卸载U盘或其他存储设备，需要很长时间，使用sync。



其中包含已修改的 i-node、已延迟的块 I/O 和读写映射文件。

sync命令的作用是，将有关文件系统的存储器常驻信息送入物理介质内。在暂停系统之前，比如要重新启动机器，一定要去执行sync命令。unix系统运行经验表明，为确保可靠起见，应执行两遍sync命令，这是因为sync命令完成时，并不保证信息实际写到了磁盘上，虽然已经执行了一遍这个命令。在执行sync命令以后，要等待磁盘工作灯灭了（假定有系统工作指示灯的话），再去真正暂停机器的运行或启动机器。

unix系统遭受破坏是随时都可能发生的事情，因此在启动机器或关机之前一定要运行sync命令。记住在任何情况下，慎重地执行sync命令决不会有任何坏处

Linux文件系统更新是一个复杂的过程，当用户程序对文件系统进行修改后，例如进行了写操作，文件数据把修改记录在内核缓冲中，在数据没有写到磁盘的时候，依然能够执行用户进程，所有数据的改变都在inode的内容中得到反映。磁盘的数据更新实际上是异步进行的，很有可能在写操作已经完成很长时间以后才真正对磁盘的数据进行更新。

sync命令强制把磁盘缓冲的所有数据写入磁盘，如果在没有把磁盘缓冲区的信息写入磁盘之前终止系统，则磁盘的文件系统就会处在一个不稳定的状态。

cp文件之后要执行 sync 命令将缓冲区的内容写到磁盘中,然后再umount 就不会出现延时